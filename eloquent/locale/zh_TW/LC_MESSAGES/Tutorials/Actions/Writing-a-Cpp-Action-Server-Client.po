# SOME DESCRIPTIVE TITLE.
# Copyright (C) 2018, Open Robotics
# This file is distributed under the same license as the ros2 documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: ros2 documentation eloquent\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-08-13 06:54+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: zh_TW\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:4
msgid "Writing an action server and client (C++)"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:6
msgid "**Goal:** Implement an action server and client in C++."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:8
msgid "**Tutorial level:** Intermediate"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:10
msgid "**Time:** 15 minutes"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:14
msgid "Contents"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:17
msgid "Background"
msgstr "背景"

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:19
msgid ""
"Actions are a form of asynchronous communication in ROS. *Action clients* "
"send goal requests to *action servers*. *Action servers* send goal feedback "
"and results to *action clients*."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:24
msgid "Prerequisites"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:26
msgid ""
"You will need the ``action_tutorials_interfaces`` package and the "
"``Fibonacci.action`` interface defined in the previous tutorial, :ref:"
"`ActionCreate`."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:30
msgid "Tasks"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:33
msgid "1 Creating the action_tutorials_cpp package"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:35
msgid ""
"As we saw in the :ref:`CreatePkg` tutorial, we need to create a new package "
"to hold our C++ and supporting code."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:38
msgid "1.1 Creating the action_tutorials_cpp package"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:40
msgid ""
"Go into the action workspace you created in the previous tutorial, and "
"create a new package for the C++ action server:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:42
msgid ""
"(Remember to :ref:`source the workspace from the previous tutorial "
"<ActionCreate>` first.)"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:46
msgid "Linux"
msgstr "Linux"

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:48
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:55
msgid ""
"cd ~/action_ws/src\n"
"ros2 pkg create --dependencies action_tutorials_interfaces rclcpp "
"rclcpp_action rclcpp_components -- action_tutorials_cpp"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:53
msgid "macOS"
msgstr "macOS"

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:60
msgid "Windows"
msgstr "Windows"

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:62
msgid ""
"cd \\dev\\action_ws\\src\n"
"ros2 pkg create --dependencies action_tutorials_interfaces rclcpp "
"rclcpp_action rclcpp_components -- action_tutorials_cpp"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:68
msgid "1.2 Adding in visibility control"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:70
msgid ""
"In order to make the package compile and work on Windows, we need to add in "
"some \"visibility control\". For details on why this is needed, see `here "
"<https://docs.microsoft.com/en-us/cpp/cpp/dllexport-dllimport>`_."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:73
msgid ""
"Open up ``action_tutorials_cpp/include/action_tutorials_cpp/"
"visibility_control.h``, and put the following code in:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:75
msgid ""
"#ifndef ACTION_TUTORIALS_CPP__VISIBILITY_CONTROL_H_\n"
"#define ACTION_TUTORIALS_CPP__VISIBILITY_CONTROL_H_\n"
"\n"
"#ifdef __cplusplus\n"
"extern \"C\"\n"
"{\n"
"#endif\n"
"\n"
"// This logic was borrowed (then namespaced) from the examples on the gcc "
"wiki:\n"
"//     https://gcc.gnu.org/wiki/Visibility\n"
"\n"
"#if defined _WIN32 || defined __CYGWIN__\n"
"  #ifdef __GNUC__\n"
"    #define ACTION_TUTORIALS_CPP_EXPORT __attribute__ ((dllexport))\n"
"    #define ACTION_TUTORIALS_CPP_IMPORT __attribute__ ((dllimport))\n"
"  #else\n"
"    #define ACTION_TUTORIALS_CPP_EXPORT __declspec(dllexport)\n"
"    #define ACTION_TUTORIALS_CPP_IMPORT __declspec(dllimport)\n"
"  #endif\n"
"  #ifdef ACTION_TUTORIALS_CPP_BUILDING_DLL\n"
"    #define ACTION_TUTORIALS_CPP_PUBLIC ACTION_TUTORIALS_CPP_EXPORT\n"
"  #else\n"
"    #define ACTION_TUTORIALS_CPP_PUBLIC ACTION_TUTORIALS_CPP_IMPORT\n"
"  #endif\n"
"  #define ACTION_TUTORIALS_CPP_PUBLIC_TYPE ACTION_TUTORIALS_CPP_PUBLIC\n"
"  #define ACTION_TUTORIALS_CPP_LOCAL\n"
"#else\n"
"  #define ACTION_TUTORIALS_CPP_EXPORT __attribute__ "
"((visibility(\"default\")))\n"
"  #define ACTION_TUTORIALS_CPP_IMPORT\n"
"  #if __GNUC__ >= 4\n"
"    #define ACTION_TUTORIALS_CPP_PUBLIC __attribute__ "
"((visibility(\"default\")))\n"
"    #define ACTION_TUTORIALS_CPP_LOCAL  __attribute__ "
"((visibility(\"hidden\")))\n"
"  #else\n"
"    #define ACTION_TUTORIALS_CPP_PUBLIC\n"
"    #define ACTION_TUTORIALS_CPP_LOCAL\n"
"  #endif\n"
"  #define ACTION_TUTORIALS_CPP_PUBLIC_TYPE\n"
"#endif\n"
"\n"
"#ifdef __cplusplus\n"
"}\n"
"#endif\n"
"\n"
"#endif  // ACTION_TUTORIALS_CPP__VISIBILITY_CONTROL_H_"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:123
msgid "2 Writing an action server"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:125
msgid ""
"Let's focus on writing an action server that computes the Fibonacci sequence "
"using the action we created in the :ref:`ActionCreate` tutorial."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:128
msgid "2.1 Writing the action server code"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:130
msgid ""
"Open up ``action_tutorials_cpp/src/fibonacci_action_server.cpp``, and put "
"the following code in:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:132
msgid ""
"#include <functional>\n"
"#include <memory>\n"
"#include <thread>\n"
"\n"
"#include \"action_tutorials_interfaces/action/fibonacci.hpp\"\n"
"#include \"rclcpp/rclcpp.hpp\"\n"
"#include \"rclcpp_action/rclcpp_action.hpp\"\n"
"#include \"rclcpp_components/register_node_macro.hpp\"\n"
"\n"
"#include \"action_tutorials_cpp/visibility_control.h\"\n"
"\n"
"namespace action_tutorials_cpp\n"
"{\n"
"class FibonacciActionServer : public rclcpp::Node\n"
"{\n"
"public:\n"
"  using Fibonacci = action_tutorials_interfaces::action::Fibonacci;\n"
"  using GoalHandleFibonacci = rclcpp_action::ServerGoalHandle<Fibonacci>;\n"
"\n"
"  ACTION_TUTORIALS_CPP_PUBLIC\n"
"  explicit FibonacciActionServer(const rclcpp::NodeOptions & options = "
"rclcpp::NodeOptions())\n"
"  : Node(\"fibonacci_action_server\", options)\n"
"  {\n"
"    using namespace std::placeholders;\n"
"\n"
"    this->action_server_ = rclcpp_action::create_server<Fibonacci>(\n"
"      this,\n"
"      \"fibonacci\",\n"
"      std::bind(&FibonacciActionServer::handle_goal, this, _1, _2),\n"
"      std::bind(&FibonacciActionServer::handle_cancel, this, _1),\n"
"      std::bind(&FibonacciActionServer::handle_accepted, this, _1));\n"
"  }\n"
"\n"
"private:\n"
"  rclcpp_action::Server<Fibonacci>::SharedPtr action_server_;\n"
"\n"
"  rclcpp_action::GoalResponse handle_goal(\n"
"    const rclcpp_action::GoalUUID & uuid,\n"
"    std::shared_ptr<const Fibonacci::Goal> goal)\n"
"  {\n"
"    RCLCPP_INFO(this->get_logger(), \"Received goal request with order %d\", "
"goal->order);\n"
"    (void)uuid;\n"
"    return rclcpp_action::GoalResponse::ACCEPT_AND_EXECUTE;\n"
"  }\n"
"\n"
"  rclcpp_action::CancelResponse handle_cancel(\n"
"    const std::shared_ptr<GoalHandleFibonacci> goal_handle)\n"
"  {\n"
"    RCLCPP_INFO(this->get_logger(), \"Received request to cancel goal\");\n"
"    (void)goal_handle;\n"
"    return rclcpp_action::CancelResponse::ACCEPT;\n"
"  }\n"
"\n"
"  void handle_accepted(const std::shared_ptr<GoalHandleFibonacci> "
"goal_handle)\n"
"  {\n"
"    using namespace std::placeholders;\n"
"    // this needs to return quickly to avoid blocking the executor, so spin "
"up a new thread\n"
"    std::thread{std::bind(&FibonacciActionServer::execute, this, _1), "
"goal_handle}.detach();\n"
"  }\n"
"\n"
"  void execute(const std::shared_ptr<GoalHandleFibonacci> goal_handle)\n"
"  {\n"
"    RCLCPP_INFO(this->get_logger(), \"Executing goal\");\n"
"    rclcpp::Rate loop_rate(1);\n"
"    const auto goal = goal_handle->get_goal();\n"
"    auto feedback = std::make_shared<Fibonacci::Feedback>();\n"
"    auto & sequence = feedback->partial_sequence;\n"
"    sequence.push_back(0);\n"
"    sequence.push_back(1);\n"
"    auto result = std::make_shared<Fibonacci::Result>();\n"
"\n"
"    for (int i = 1; (i < goal->order) && rclcpp::ok(); ++i) {\n"
"      // Check if there is a cancel request\n"
"      if (goal_handle->is_canceling()) {\n"
"        result->sequence = sequence;\n"
"        goal_handle->canceled(result);\n"
"        RCLCPP_INFO(this->get_logger(), \"Goal canceled\");\n"
"        return;\n"
"      }\n"
"      // Update sequence\n"
"      sequence.push_back(sequence[i] + sequence[i - 1]);\n"
"      // Publish feedback\n"
"      goal_handle->publish_feedback(feedback);\n"
"      RCLCPP_INFO(this->get_logger(), \"Publish feedback\");\n"
"\n"
"      loop_rate.sleep();\n"
"    }\n"
"\n"
"    // Check if goal is done\n"
"    if (rclcpp::ok()) {\n"
"      result->sequence = sequence;\n"
"      goal_handle->succeed(result);\n"
"      RCLCPP_INFO(this->get_logger(), \"Goal succeeded\");\n"
"    }\n"
"  }\n"
"};  // class FibonacciActionServer\n"
"\n"
"}  // namespace action_tutorials_cpp\n"
"\n"
"RCLCPP_COMPONENTS_REGISTER_NODE(action_tutorials_cpp::"
"FibonacciActionServer)\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:136
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:263
msgid "The first few lines include all of the headers we need to compile."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:138
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:265
msgid "Next we create a class that is a derived class of ``rclcpp::Node``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:140
msgid "class FibonacciActionServer : public rclcpp::Node\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:144
msgid ""
"The constructor for the ``FibonacciActionServer`` class initializes the node "
"name as ``fibonacci_action_server``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:146
msgid ""
"  explicit FibonacciActionServer(const rclcpp::NodeOptions & options = "
"rclcpp::NodeOptions())\n"
"  : Node(\"fibonacci_action_server\", options)\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:150
msgid "The constructor also instantiates a new action server:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:152
msgid ""
"    this->action_server_ = rclcpp_action::create_server<Fibonacci>(\n"
"      this,\n"
"      \"fibonacci\",\n"
"      std::bind(&FibonacciActionServer::handle_goal, this, _1, _2),\n"
"      std::bind(&FibonacciActionServer::handle_cancel, this, _1),\n"
"      std::bind(&FibonacciActionServer::handle_accepted, this, _1));\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:156
msgid "An action server requires 6 things:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:158
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:285
msgid "The templated action type name: ``Fibonacci``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:159
msgid "A ROS 2 node to add the action to: ``this``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:160
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:287
msgid "The action name: ``'fibonacci'``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:161
msgid "A callback function for handling goals: ``handle_goal``"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:162
msgid "A callback function for handling cancellation: ``handle_cancel``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:163
msgid "A callback function for handling goal accept: ``handle_accept``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:165
msgid ""
"The implementation of the various callbacks is next in the file. Note that "
"all of the callbacks need to return quickly, otherwise we risk starving the "
"executor."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:168
msgid "We start with the callback for handling new goals:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:170
msgid ""
"  rclcpp_action::GoalResponse handle_goal(\n"
"    const rclcpp_action::GoalUUID & uuid,\n"
"    std::shared_ptr<const Fibonacci::Goal> goal)\n"
"  {\n"
"    RCLCPP_INFO(this->get_logger(), \"Received goal request with order %d\", "
"goal->order);\n"
"    (void)uuid;\n"
"    return rclcpp_action::GoalResponse::ACCEPT_AND_EXECUTE;\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:174
msgid "This implementation just accepts all goals."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:176
msgid "Next up is the callback for dealing with cancellation:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:178
msgid ""
"  rclcpp_action::CancelResponse handle_cancel(\n"
"    const std::shared_ptr<GoalHandleFibonacci> goal_handle)\n"
"  {\n"
"    RCLCPP_INFO(this->get_logger(), \"Received request to cancel goal\");\n"
"    (void)goal_handle;\n"
"    return rclcpp_action::CancelResponse::ACCEPT;\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:182
msgid ""
"This implementation just tells the client that it accepted the cancellation."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:184
msgid "The last of the callbacks accepts a new goal and starts processing it:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:186
msgid ""
"  void handle_accepted(const std::shared_ptr<GoalHandleFibonacci> "
"goal_handle)\n"
"  {\n"
"    using namespace std::placeholders;\n"
"    // this needs to return quickly to avoid blocking the executor, so spin "
"up a new thread\n"
"    std::thread{std::bind(&FibonacciActionServer::execute, this, _1), "
"goal_handle}.detach();\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:190
msgid ""
"Since the execution is a long-running operation, we spawn off a thread to do "
"the actual work and return from ``handle_accepted`` quickly."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:192
msgid ""
"All further processing and updates are done in the ``execute`` method in the "
"new thread:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:194
msgid ""
"  void execute(const std::shared_ptr<GoalHandleFibonacci> goal_handle)\n"
"  {\n"
"    RCLCPP_INFO(this->get_logger(), \"Executing goal\");\n"
"    rclcpp::Rate loop_rate(1);\n"
"    const auto goal = goal_handle->get_goal();\n"
"    auto feedback = std::make_shared<Fibonacci::Feedback>();\n"
"    auto & sequence = feedback->partial_sequence;\n"
"    sequence.push_back(0);\n"
"    sequence.push_back(1);\n"
"    auto result = std::make_shared<Fibonacci::Result>();\n"
"\n"
"    for (int i = 1; (i < goal->order) && rclcpp::ok(); ++i) {\n"
"      // Check if there is a cancel request\n"
"      if (goal_handle->is_canceling()) {\n"
"        result->sequence = sequence;\n"
"        goal_handle->canceled(result);\n"
"        RCLCPP_INFO(this->get_logger(), \"Goal canceled\");\n"
"        return;\n"
"      }\n"
"      // Update sequence\n"
"      sequence.push_back(sequence[i] + sequence[i - 1]);\n"
"      // Publish feedback\n"
"      goal_handle->publish_feedback(feedback);\n"
"      RCLCPP_INFO(this->get_logger(), \"Publish feedback\");\n"
"\n"
"      loop_rate.sleep();\n"
"    }\n"
"\n"
"    // Check if goal is done\n"
"    if (rclcpp::ok()) {\n"
"      result->sequence = sequence;\n"
"      goal_handle->succeed(result);\n"
"      RCLCPP_INFO(this->get_logger(), \"Goal succeeded\");\n"
"    }\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:198
msgid ""
"This work thread processes one sequence number of the Fibonacci sequence "
"every second, publishing a feedback update for each step. When it has "
"finished processing, it marks the ``goal_handle`` as succeeded, and quits."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:201
msgid ""
"We now have a fully functioning action server.  Let's get it built and "
"running."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:204
msgid "2.2 Compiling the action server"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:206
msgid ""
"In the previous section we put the action server code into place. To get it "
"to compile and run, we need to do a couple of additional things."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:209
msgid ""
"First we need to setup the CMakeLists.txt so that the action server is "
"compiled. Open up ``action_tutorials_cpp/CMakeLists.txt``, and add the "
"following right after the ``find_package`` calls:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:212
msgid ""
"add_library(action_server SHARED\n"
"  src/fibonacci_action_server.cpp)\n"
"target_include_directories(action_server PRIVATE\n"
"  $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>\n"
"  $<INSTALL_INTERFACE:include>)\n"
"target_compile_definitions(action_server\n"
"  PRIVATE \"ACTION_TUTORIALS_CPP_BUILDING_DLL\")\n"
"ament_target_dependencies(action_server\n"
"  \"action_tutorials_interfaces\"\n"
"  \"rclcpp\"\n"
"  \"rclcpp_action\"\n"
"  \"rclcpp_components\")\n"
"rclcpp_components_register_node(action_server PLUGIN \"action_tutorials_cpp::"
"FibonacciActionServer\" EXECUTABLE fibonacci_action_server)\n"
"install(TARGETS\n"
"  action_server\n"
"  ARCHIVE DESTINATION lib\n"
"  LIBRARY DESTINATION lib\n"
"  RUNTIME DESTINATION bin)"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:233
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:362
msgid ""
"And now we can compile the package.  Go to the top-level of the "
"``action_ws``, and run:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:235
#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:364
msgid "colcon build"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:239
msgid ""
"This should compile the entire workspace, including the "
"``fibonacci_action_server`` in the ``action_tutorials_cpp`` package."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:242
msgid "2.3 Running the action server"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:244
msgid ""
"Now that we have the action server built, we can run it. Source the "
"workspace we just built (``action_ws``), and try to run the action server:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:247
msgid "ros2 run action_tutorials_cpp fibonacci_action_server"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:252
msgid "3 Writing an action client"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:255
msgid "3.1 Writing the action client code"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:257
msgid ""
"Open up ``action_tutorials_cpp/src/fibonacci_action_client.cpp``, and put "
"the following code in:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:259
msgid ""
"#include <functional>\n"
"#include <future>\n"
"#include <memory>\n"
"#include <string>\n"
"#include <sstream>\n"
"\n"
"#include \"action_tutorials_interfaces/action/fibonacci.hpp\"\n"
"\n"
"#include \"rclcpp/rclcpp.hpp\"\n"
"#include \"rclcpp_action/rclcpp_action.hpp\"\n"
"#include \"rclcpp_components/register_node_macro.hpp\"\n"
"\n"
"namespace action_tutorials_cpp\n"
"{\n"
"class FibonacciActionClient : public rclcpp::Node\n"
"{\n"
"public:\n"
"  using Fibonacci = action_tutorials_interfaces::action::Fibonacci;\n"
"  using GoalHandleFibonacci = rclcpp_action::ClientGoalHandle<Fibonacci>;\n"
"\n"
"  explicit FibonacciActionClient(const rclcpp::NodeOptions & options)\n"
"  : Node(\"fibonacci_action_client\", options)\n"
"  {\n"
"    this->client_ptr_ = rclcpp_action::create_client<Fibonacci>(\n"
"      this,\n"
"      \"fibonacci\");\n"
"\n"
"    this->timer_ = this->create_wall_timer(\n"
"      std::chrono::milliseconds(500),\n"
"      std::bind(&FibonacciActionClient::send_goal, this));\n"
"  }\n"
"\n"
"  void send_goal()\n"
"  {\n"
"    using namespace std::placeholders;\n"
"\n"
"    this->timer_->cancel();\n"
"\n"
"    if (!this->client_ptr_->wait_for_action_server()) {\n"
"      RCLCPP_ERROR(this->get_logger(), \"Action server not available after "
"waiting\");\n"
"      rclcpp::shutdown();\n"
"    }\n"
"\n"
"    auto goal_msg = Fibonacci::Goal();\n"
"    goal_msg.order = 10;\n"
"\n"
"    RCLCPP_INFO(this->get_logger(), \"Sending goal\");\n"
"\n"
"    auto send_goal_options = rclcpp_action::Client<Fibonacci>::"
"SendGoalOptions();\n"
"    send_goal_options.goal_response_callback =\n"
"      std::bind(&FibonacciActionClient::goal_response_callback, this, _1);\n"
"    send_goal_options.feedback_callback =\n"
"      std::bind(&FibonacciActionClient::feedback_callback, this, _1, _2);\n"
"    send_goal_options.result_callback =\n"
"      std::bind(&FibonacciActionClient::result_callback, this, _1);\n"
"    this->client_ptr_->async_send_goal(goal_msg, send_goal_options);\n"
"  }\n"
"\n"
"private:\n"
"  rclcpp_action::Client<Fibonacci>::SharedPtr client_ptr_;\n"
"  rclcpp::TimerBase::SharedPtr timer_;\n"
"\n"
"  void goal_response_callback(std::shared_future<GoalHandleFibonacci::"
"SharedPtr> future)\n"
"  {\n"
"    auto goal_handle = future.get();\n"
"    if (!goal_handle) {\n"
"      RCLCPP_ERROR(this->get_logger(), \"Goal was rejected by server\");\n"
"    } else {\n"
"      RCLCPP_INFO(this->get_logger(), \"Goal accepted by server, waiting for "
"result\");\n"
"    }\n"
"  }\n"
"\n"
"  void feedback_callback(\n"
"    GoalHandleFibonacci::SharedPtr,\n"
"    const std::shared_ptr<const Fibonacci::Feedback> feedback)\n"
"  {\n"
"    std::stringstream ss;\n"
"    ss << \"Next number in sequence received: \";\n"
"    for (auto number : feedback->partial_sequence) {\n"
"      ss << number << \" \";\n"
"    }\n"
"    RCLCPP_INFO(this->get_logger(), ss.str().c_str());\n"
"  }\n"
"\n"
"  void result_callback(const GoalHandleFibonacci::WrappedResult & result)\n"
"  {\n"
"    switch (result.code) {\n"
"      case rclcpp_action::ResultCode::SUCCEEDED:\n"
"        break;\n"
"      case rclcpp_action::ResultCode::ABORTED:\n"
"        RCLCPP_ERROR(this->get_logger(), \"Goal was aborted\");\n"
"        return;\n"
"      case rclcpp_action::ResultCode::CANCELED:\n"
"        RCLCPP_ERROR(this->get_logger(), \"Goal was canceled\");\n"
"        return;\n"
"      default:\n"
"        RCLCPP_ERROR(this->get_logger(), \"Unknown result code\");\n"
"        return;\n"
"    }\n"
"    std::stringstream ss;\n"
"    ss << \"Result received: \";\n"
"    for (auto number : result.result->sequence) {\n"
"      ss << number << \" \";\n"
"    }\n"
"    RCLCPP_INFO(this->get_logger(), ss.str().c_str());\n"
"    rclcpp::shutdown();\n"
"  }\n"
"};  // class FibonacciActionClient\n"
"\n"
"}  // namespace action_tutorials_cpp\n"
"\n"
"RCLCPP_COMPONENTS_REGISTER_NODE(action_tutorials_cpp::"
"FibonacciActionClient)\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:267
msgid "class FibonacciActionClient : public rclcpp::Node\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:271
msgid ""
"The constructor for the ``FibonacciActionClient`` class initializes the node "
"name as ``fibonacci_action_client``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:273
msgid ""
"\n"
"  explicit FibonacciActionClient(const rclcpp::NodeOptions & options)\n"
"  : Node(\"fibonacci_action_client\", options)\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:277
msgid "The constructor also instantiates a new action client:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:279
msgid ""
"    this->client_ptr_ = rclcpp_action::create_client<Fibonacci>(\n"
"      this,\n"
"      \"fibonacci\");\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:283
msgid "An action client requires 3 things:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:286
msgid "A ROS 2 node to add the action client to: ``this``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:289
msgid ""
"We also instantiate a ROS timer that will kick off the one and only call to "
"``send_goal``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:291
msgid ""
"\n"
"    this->timer_ = this->create_wall_timer(\n"
"      std::chrono::milliseconds(500),\n"
"      std::bind(&FibonacciActionClient::send_goal, this));\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:295
msgid "When the timer expires, it will call ``send_goal``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:297
msgid ""
"\n"
"  void send_goal()\n"
"  {\n"
"    using namespace std::placeholders;\n"
"\n"
"    this->timer_->cancel();\n"
"\n"
"    if (!this->client_ptr_->wait_for_action_server()) {\n"
"      RCLCPP_ERROR(this->get_logger(), \"Action server not available after "
"waiting\");\n"
"      rclcpp::shutdown();\n"
"    }\n"
"\n"
"    auto goal_msg = Fibonacci::Goal();\n"
"    goal_msg.order = 10;\n"
"\n"
"    RCLCPP_INFO(this->get_logger(), \"Sending goal\");\n"
"\n"
"    auto send_goal_options = rclcpp_action::Client<Fibonacci>::"
"SendGoalOptions();\n"
"    send_goal_options.goal_response_callback =\n"
"      std::bind(&FibonacciActionClient::goal_response_callback, this, _1);\n"
"    send_goal_options.feedback_callback =\n"
"      std::bind(&FibonacciActionClient::feedback_callback, this, _1, _2);\n"
"    send_goal_options.result_callback =\n"
"      std::bind(&FibonacciActionClient::result_callback, this, _1);\n"
"    this->client_ptr_->async_send_goal(goal_msg, send_goal_options);\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:301
msgid "This function does the following:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:303
msgid "Cancels the timer (so it is only called once)."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:304
msgid "Waits for the action server to come up."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:305
msgid "Instantiates a new ``Fibonacci::Goal``."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:306
msgid "Sets the response, feedback, and result callbacks."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:307
msgid "Sends the goal to the server."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:309
msgid ""
"When the server receives and accepts the goal, it will send a response to "
"the client. That response is handled by ``goal_response_callback``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:312
msgid ""
"\n"
"  void goal_response_callback(std::shared_future<GoalHandleFibonacci::"
"SharedPtr> future)\n"
"  {\n"
"    auto goal_handle = future.get();\n"
"    if (!goal_handle) {\n"
"      RCLCPP_ERROR(this->get_logger(), \"Goal was rejected by server\");\n"
"    } else {\n"
"      RCLCPP_INFO(this->get_logger(), \"Goal accepted by server, waiting for "
"result\");\n"
"    }\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:316
msgid ""
"Assuming the goal was accepted by the server, it will start processing. Any "
"feedback to the client will be handled by the ``feedback_callback``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:319
msgid ""
"\n"
"  void feedback_callback(\n"
"    GoalHandleFibonacci::SharedPtr,\n"
"    const std::shared_ptr<const Fibonacci::Feedback> feedback)\n"
"  {\n"
"    std::stringstream ss;\n"
"    ss << \"Next number in sequence received: \";\n"
"    for (auto number : feedback->partial_sequence) {\n"
"      ss << number << \" \";\n"
"    }\n"
"    RCLCPP_INFO(this->get_logger(), ss.str().c_str());\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:323
msgid ""
"When the server is finished processing, it will return a result to the "
"client. The result is handled by the ``result_callback``:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:326
msgid ""
"\n"
"  void result_callback(const GoalHandleFibonacci::WrappedResult & result)\n"
"  {\n"
"    switch (result.code) {\n"
"      case rclcpp_action::ResultCode::SUCCEEDED:\n"
"        break;\n"
"      case rclcpp_action::ResultCode::ABORTED:\n"
"        RCLCPP_ERROR(this->get_logger(), \"Goal was aborted\");\n"
"        return;\n"
"      case rclcpp_action::ResultCode::CANCELED:\n"
"        RCLCPP_ERROR(this->get_logger(), \"Goal was canceled\");\n"
"        return;\n"
"      default:\n"
"        RCLCPP_ERROR(this->get_logger(), \"Unknown result code\");\n"
"        return;\n"
"    }\n"
"    std::stringstream ss;\n"
"    ss << \"Result received: \";\n"
"    for (auto number : result.result->sequence) {\n"
"      ss << number << \" \";\n"
"    }\n"
"    RCLCPP_INFO(this->get_logger(), ss.str().c_str());\n"
"    rclcpp::shutdown();\n"
"  }\n"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:330
msgid ""
"We now have a fully functioning action client.  Let's get it built and "
"running."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:333
msgid "3.2 Compiling the action client"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:335
msgid ""
"In the previous section we put the action client code into place. To get it "
"to compile and run, we need to do a couple of additional things."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:338
msgid ""
"First we need to setup the CMakeLists.txt so that the action client is "
"compiled. Open up ``action_tutorials_cpp/CMakeLists.txt``, and add the "
"following right after the ``find_package`` calls:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:341
msgid ""
"add_library(action_client SHARED\n"
"  src/fibonacci_action_client.cpp)\n"
"target_include_directories(action_client PRIVATE\n"
"  $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>\n"
"  $<INSTALL_INTERFACE:include>)\n"
"target_compile_definitions(action_client\n"
"  PRIVATE \"ACTION_TUTORIALS_CPP_BUILDING_DLL\")\n"
"ament_target_dependencies(action_client\n"
"  \"action_tutorials_interfaces\"\n"
"  \"rclcpp\"\n"
"  \"rclcpp_action\"\n"
"  \"rclcpp_components\")\n"
"rclcpp_components_register_node(action_client PLUGIN \"action_tutorials_cpp::"
"FibonacciActionClient\" EXECUTABLE fibonacci_action_client)\n"
"install(TARGETS\n"
"  action_client\n"
"  ARCHIVE DESTINATION lib\n"
"  LIBRARY DESTINATION lib\n"
"  RUNTIME DESTINATION bin)"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:368
msgid ""
"This should compile the entire workspace, including the "
"``fibonacci_action_client`` in the ``action_tutorials_cpp`` package."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:371
msgid "3.3 Running the action client"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:373
msgid ""
"Now that we have the action client built, we can run it. First make sure "
"that an action server is running in a separate terminal. Now source the "
"workspace we just built (``action_ws``), and try to run the action client:"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:377
msgid "ros2 run action_tutorials_cpp fibonacci_action_client"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:381
msgid ""
"You should see logged messages for the goal being accepted, feedback being "
"printed, and the final result."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:384
msgid "Summary"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:386
msgid ""
"In this tutorial, you put together a C++ action server and action client "
"line by line, and configured them to exchange goals, feedback, and results."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:389
msgid "Related content"
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:391
msgid ""
"There are several ways you could write an action server and client in C++; "
"check out the ``minimal_action_server`` and ``minimal_action_client`` "
"packages in the `ros2/examples <https://github.com/ros2/examples/tree/"
"eloquent/rclcpp>`_ repo."
msgstr ""

#: ../../../source/Tutorials/Actions/Writing-a-Cpp-Action-Server-Client.rst:393
msgid ""
"For more detailed information about ROS actions, please refer to the `design "
"article <http://design.ros2.org/articles/actions.html>`__."
msgstr ""
